---
layout: default
---
{% comment %}
{% assign cve_id = page.json.containers.cna.CVE_data_meta.ID %}
{% if page.json.containers.cna.CVE_data_meta.TITLE %}
	{% assign cve_title = page.json.containers.cna.CVE_data_meta.TITLE %}
{% else %}
	{% assign cve_title = page.json.containers.cna.description.description_data | where: "lang", "en" %}
	{% capture cve_title %}{{ cve_title[0].value }}{% endcapture %}
{% endif %}
{% assign affected = page.json.containers.cna.affects.vendor.vendor_data %}
{% assign cve_exploit = page.json.containers.cna.exploit | where: "lang", "en" %}
{% assign cve_work_around = page.json.containers.cna.work_around | where: "lang", "en" %}
{% assign cve_solution = page.json.containers.cna.solution | where: "lang", "en" %}
{% endcomment %}

{% assign cve_credits = page.json.containers.cna.credits | where: "lang", "en" %}
{% assign cvss = page.json.containers.cna.metrics | where: "format", "CVSS" %}
{% assign cve_ref = page.json.containers.cna.references  %}
{% assign cve_description = page.json.containers.cna.descriptions | where: "lang", "en" %}
{% assign problem_types = page.json.containers.cna.problemTypes %}

<h1>{{ page.cve | escape }} - {{ page.title | escape }}</h1>

{% assign team = site.team | map: "name" -%}
{% comment %}
-%-{{ page.json.containers.cna.credits }}%-%<br>
{% endcomment %}
-%-{{ affected }}%-%

<table>
	<tbody>
	    <tr>
			<td> CVE </td><td> {{ page.cve | cve }} </td>
		</tr>
		{% assign checkArray = page.json.containers.cna.source.advisory | split: "DIVD-" %}
		{% if checkArray.size == 2 and checkArray[0] == "" %}
		    <tr>
				<td> Case </td><td> <a href="/{{ page.json.containers.cna.source.advisory }}/">{{ page.json.containers.cna.source.advisory }}</a></td>
			</tr>
		{% endif %}
		{% if page.discovered_by %}
			<tr>
				<td> Discovered by </td>
				<td>
					<ul>
						{% for r in page.discovered_by -%}
							<li>
								{% if team contains r %}
									<a href='https://www.divd.nl/team/{{ r | uri_escape }}/'>{{ r }}</a>
								{% else %}
									{{ r }}
								{% endif %}
							</li>
						{% endfor %}
					</ul>
				</td>
			</tr>
		{% endif %}
		{% if cve_credits.size > 0 %}
			<tr>
				<td> Credits </td>
				<td>
					<ul>
						{% for r in cve_credits -%}
							<li>
								{% assign line = r.value %}
								{% for name in team %}
									{% if name == line %}
										{% capture line %}<a href='https://www.divd.nl/team/{{ line | uri_escape }}/'>{{ line }}</a>{% endcapture %}
									{% else %}
										{% if line contains name %}
											{% capture linkleft  %} <a href='https://www.divd.nl/team/{{ name | uri_escape }}/'>{{ name }}</a>{% endcapture %}
											{% capture linkright %}<a href='https://www.divd.nl/team/{{ name | uri_escape }}/'>{{ name }}</a> {% endcapture %}
											{% capture nameleft  %} {{ name }}{% endcapture %}
											{% capture nameright %}{{ name }} {% endcapture %}
										{% assign line = line | replace: nameleft, linkleft %}
										{% assign line = line | replace: nameright, linkright %}
										{% endif %}
									{% endif %}
								{% endfor %}
								{{ line }}
							</li>
						{% endfor %}
					</ul>
				</td>
			</tr>
		{% endif %}
		

		{% if  page.json.containers.cna.affected.size > 0 %}
			<tr>
				<td> Affected products </td>
				<td> 
					<table class="affected">
						<thead>
							<tr>
								<th>Product</th>
								<th>Affected</th>
								<th>Unaffected</th>
								<th>Unknown</th>
							</tr>
						</thead>
						<tbody>
							{% for p in page.json.containers.cna.affected %}
								<tr>
									<td rowspan="{{ p.versions.size | plus: 1}}">
										{{ p.vendor }} {{ p.product }}
										{% if p.platforms %}
											on {{ p.platforms | join: ", " }}
										{% endif %}
									</td>
									{% assign first = true %}
									{% for v in p.versions %}
										{% if first %}
											{% assign first = false %}
										{% else %}
								<tr>
										{% endif %}
										<td>
											{% if v.status == "affected" %}
												{% if v.lessThan or v.lessThanOrEqual %}
													>=
												{% else %}
													=
												{% endif %}
												{{ v.versionType }} {{ v.version }}
												{% if v.lessThan or v.lessThanOrEqual %}
													to
													{% if v.lessThan %}
														< {{ v.lessThan }}
													{% endif %}
													{% if v.lessThanOrEqual %}
														< {{ v.lessThanOrEqual }}
													{% endif %}
												{% endif %}
											{% endif %}
										</td>
										<td>
											{% if v.status == "unaffected" %}
												{% if v.lessThan or v.lessThanOrEqual %}
													>=
												{% else %}
													=
												{% endif %}
												{{ v.versionType }} {{ v.version }}
												{% if v.lessThan or v.lessThanOrEqual %}
													to
													{% if v.lessThan %}
														< {{ v.lessThan }}
													{% endif %}
													{% if v.lessThanOrEqual %}
														< {{ v.lessThanOrEqual }}
													{% endif %}
												{% endif %}
											{% endif %}
										</td>
										<td>
											{% if v.status == "unknown" %}
												{% if v.lessThan or v.lessThanOrEqual %}
													>=
												{% else %}
													=
												{% endif %}
												{{ v.versionType }} {{ v.version }}
												{% if v.lessThan or v.lessThanOrEqual %}
													to
													{% if v.lessThan %}
														< {{ v.lessThan }}
													{% endif %}
													{% if v.lessThanOrEqual %}
														< {{ v.lessThanOrEqual }}
													{% endif %}
												{% endif %}
											{% endif %}
										</td>
								</tr>
									{% endfor %}
								<tr>
									<td>{% if p.defaultStatus == "affected" %}everything else{% endif %}</td>
									<td>{% if p.defaultStatus == "unaffected" %}everything else{% endif %}</td>
									<td>{% if p.defaultStatus == "unknown" %}everything else{% endif %}</td>
								</tr>
							{% endfor %}							
						</tbody>
					</table>
				</td>
			</tr>
		{% endif %}
		{% if page.author %}
			<tr>
				<td> Page author </td>
				<td>
					{% if team contains page.author %}
						<a href='https://www.divd.nl/team/{{ page.author | uri_escape }}/'>{{ page.author }}</a>
					{% else %}
						{{ page.author }}
					{% endif %}
				</td>
			</tr>
		{% endif %}
		<tr>
			<td> CVSS </td>
			<td> 
				{% for c in cvss %}
					{% if cvss.size > 1 %}

						Scenario {{ forloop.index }} :
						{% assign scen = c.scenarios | where: "lang", "en" %}
						{% for s in scen %}
							{{ s.value }}
						{% endfor %}
						<br>
					{% endif %}
					Base score: 
					<a href='https://www.first.org/cvss/calculator/3.1#{{  c.cvssV3_1.vectorString }}'>{{ c.cvssV3_1.baseScore }}</a>
					({{ c.cvssV3_1.baseSeverity }})<br>
					{% if cvss.size > 1 %}<br>{% endif %}
				{% endfor %}
			</td>
		</tr>
		{% if cve_ref.size > 0  %}
			<tr>
				<td> References </td>
				<td>
					{% if cve_ref.size > 1 %}<ul>{% endif %}
						{% for r in cve_ref -%}
							{% if cve_ref.size > 1 %}<li>{% endif %}
								<a href='{{ r.url }}/'>{{ r.url }}</a>
								{% if r.tags and r.tags.size > 0 %}
									( {{ r.tags | join: ", " }} )
								{% endif %}
							{% if cve_ref.size > 1 %}</li>{% endif %}
						{% endfor %}
					{% if cve_ref.size > 1 %}</ul>{% endif %}
				</td>
			</tr>
		{% endif %}
		{% if problem_types.size > 0 %}
			<tr>
				<td> Problem type(s) </td>
				<td>
					{% if problem_types.size > 1 %}<ul>{% endif %}
					{% for p in problem_types %}
						{% if problem_types.size > 1 %}<li>{% endif %}
							{% for d in p.descriptions %}
								{% if d.lang == "en" %}
									{% if d.type == "CWE" %}
										{% assign cwe = d.cweId | replace: "CWE-", "" %}
										<a href="https://cwe.mitre.org/data/definitions/{{ cwe }}.html">{{ d.description }}</a>
									{% else %}
										{{ d.description }}
									{% endif %}
								{% endif %}
							{% endfor %}
						{% if problem_types.size > 1 %}</li>{% endif %}
					{% endfor %}
				</td>
			</tr>
		{% endif %}
		{% if  page.json.containers.cna.impacts.size > 0 %}
			<tr>
				<td> Impact(s) </td>
				<td>
					{% if  page.json.containers.cna.impacts.size > 1 %}<ul>{% endif %}
					{% for i in  page.json.containers.cna.impacts %}
						{% if  page.json.containers.cna.impacts.size > 1 %}<li>{% endif %}
						{% assign capec = i.capecId | replace: "CAPEC-", "" %}
						{% assign desc = i.descriptions | where: "lang", "en" %}
						<a href="https://capec.mitre.org/data/definitions/{{ capec }}.html">
							{%- for d in desc %}{{ d.value }}{% endfor -%}
						</a>
						{% if  page.json.containers.cna.impacts.size > 1 %}</li>{% endif %}
					{% endfor %}
					{% if  page.json.containers.cna.impacts.size > 1 %}</ul>{% endif %}
				</td>
			</tr>
		{% endif %}

		{% assign list = page.json.containers.cna.configurations | where: "lang", "en" %}
		{% if list.size > 0 %}
			<tr>
				<td> Configuration(s) </td>
				<td>
					{% for i in list %}
						{% if list.size > 1 %}<ul>{% endif %}
						{% if list.size > 1 %}<li>{% endif %}
						{{ i.value | escape }}
						{% if list.size > 1 %}</li>{% endif %}
						{% if list.size > 1 %}</ul>{% endif %}
					{% endfor %}
				</td>
			</tr>
		{% endif %}

		{% assign list = page.json.containers.cna.solutions | where: "lang", "en" %}
		{% if list.size > 0 %}
			<tr>
				<td> Solution(s) </td>
				<td>
					{% for i in list %}
						{% if list.size > 1 %}<ul>{% endif %}
						{% if list.size > 1 %}<li>{% endif %}
						{{ i.value | escape }}
						{% if list.size > 1 %}</li>{% endif %}
						{% if list.size > 1 %}</ul>{% endif %}
					{% endfor %}
				</td>
			</tr>
		{% endif %}


		{% assign list = page.json.containers.cna.exploits | where: "lang", "en" %}
		{% if list.size > 0 %}
			<tr>
				<td> Exploit(s) </td>
				<td>
					{% for i in list %}
						{% if list.size > 1 %}<ul>{% endif %}
						{% if list.size > 1 %}<li>{% endif %}
						{{ i.value | escape }}
						{% if list.size > 1 %}</li>{% endif %}
						{% if list.size > 1 %}</ul>{% endif %}
					{% endfor %}
				</td>
			</tr>
		{% endif %}

		<tr>
			<td>
				Last modified
			</td>
			<td>
				{{ page.last_modified_at | date: "%d %b %Y %H:%M"}}
			</td>
		</tr>
	</tbody>
</table>

<h2>Description</h2>

{% for d in cve_description %}
	<div>{{ d.value | markdownify }}</div>
{% endfor %}


{{ content }} 		

<br>

<a href="/cves/{{ page.cve }}.json">JSON version</a>

{% include disclaimer.html %}
